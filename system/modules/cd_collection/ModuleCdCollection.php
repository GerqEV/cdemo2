<?php if (!defined('TL_ROOT')) die('You can not access this file directly!');/** * Contao Open Source CMS * Copyright (C) 2005-2010 Leo Feyer * * Formerly known as TYPOlight Open Source CMS. * * This program is free software: you can redistribute it and/or * modify it under the terms of the GNU Lesser General Public * License as published by the Free Software Foundation, either * version 3 of the License, or (at your option) any later version. *  * This program is distributed in the hope that it will be useful, * but WITHOUT ANY WARRANTY; without even the implied warranty of * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU * Lesser General Public License for more details. *  * You should have received a copy of the GNU Lesser General Public * License along with this program. If not, please visit the Free * Software Foundation website at <http://www.gnu.org/licenses/>. * * PHP version 5 * @copyright  Kamil Kuzminski 2010 * @author     Kamil Kuzminski <http://qzminski.com> * @package    CD Collection * @license    LGPL * @filesource */ /** * Class ModuleCdCollection * * Front end module "cd_collection". * @copyright  Kamil Kuzminski 2010 * @author     Kamil Kuzminski <http://qzminski.com> * @package    Controller */class ModuleCdCollection extends Module{	/**	 * Template	 * @var string	 */	protected $strTemplate = 'mod_cdcollection';			/**	 * Display a wildcard in the back end	 * @return string	 */	public function generate()	{		if (TL_MODE == 'BE')		{			$objTemplate = new BackendTemplate('be_wildcard');			$objTemplate->wildcard = '### CD COLLECTION LIST ###';			$objTemplate->title = $this->headline;			$objTemplate->id = $this->id;			$objTemplate->link = $this->name;			$objTemplate->href = 'contao/main.php?do=themes&amp;table=tl_module&amp;act=edit&amp;id=' . $this->id;			return $objTemplate->parse();		}				return parent::generate();	}			/**	 * Generate module	 */	protected function compile()	{		$arrCds = array();				// Get category ID		$intCategory = ($this->Input->get('cat')) ? $this->Input->get('cat') : 1;				// Fetch data from the database		$objCds = $this->Database->prepare("SELECT * FROM tl_cds WHERE pid=? ORDER BY title")->execute($intCategory);		$objCategory = $this->Database->prepare("SELECT * FROM tl_cds_category WHERE id=?")->execute($intCategory);		$objCategories = $this->Database->execute("SELECT id, title FROM tl_cds_category ORDER BY title");				// Put CDs of current category into array		while ($objCds->next())		{			$arrCds[] = array			(				'title' => $objCds->title,				'artist' => $objCds->artist,				'comment' => $objCds->comment,				'src' => $objCds->image,				'alt' => $objCds->title			);		}				// Put all categories into array				while ($objCategories->next())		{			$blnSelected = ($objCategories->id == $intCategory) ? true : false;					$arrCategories[] = array			(				'id' => $objCategories->id,				'title' => $objCategories->title,				'selected' => $blnSelected			);		}				// Assign data to the template		$this->Template->cds = $arrCds;		$this->Template->catTitle = $objCategory->title;		$this->Template->catDescription = $objCategory->description;		$this->Template->categories = $arrCategories;	}}?>